<!DOCTYPE html>
<html lang="en">

<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Meta tags for SEO -->
    <meta name="description"
        content="Love Gardens. Gardening enthusiasts, lawns, proper planting, drainage, Scarifying Aerating lawns">
    <meta name="keywords"
        content="Flowers and shrubs in season, Power washing & moss removal, drains and shoots, Hedges and trees maintenance, Vegetable area - potatoes, Fruit trees and bushes, Sustainable patch for bees, Fallow area, Compost heaps, Mulch area">

    <!-- Title block -->
    <title>{% block title %}Beautiful outdoor spaces{% endblock %}</title>

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'core/images/favicon/apple-touch-icon.png' %}">
    <link rel="icon" type="image/png" sizes="32x32" href="{% static 'core/images/favicon_io/favicon-32x32.png' %}">
    <link rel="icon" type="image/png" sizes="16x16" href="{% static 'core/images/favicon/favicon-16x16.png' %}">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <!-- Custom Stylesheet -->
    <link rel="stylesheet" href="{% static 'core/css/style.css' %}">

    {% block extra_head %}{% endblock %}
</head>

<body>

    <!-- Header -->
    {% include 'core/includes/header.html' %}

    <!-- Main content -->
    <main>
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    {% include 'core/includes/footer.html' %}

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/aa9af45995.js" crossorigin="anonymous"></script>

    <!-- Header offset script: sets --header-height to prevent content hiding under fixed header -->
    <script src="{% static 'core/js/header-offset.js' %}"></script>

    <!-- Site session ID for anonymous users (stored in localStorage).
         - Creates `localStorage.site_session` as JSON: {id, created_at}
         - Only created when there is no session present AND the user is anonymous.
         - Exposes `window.siteSession` and `window.siteSessionId` for other scripts (booking forms).
    -->
    <script>
    (function(){
        var storageKey = 'site_session';
        function makeId(){
            try{ if(window.crypto && crypto.randomUUID) return crypto.randomUUID(); }catch(e){}
            return 's-' + Math.random().toString(36).slice(2,12);
        }
        function nowISO(){ return new Date().toISOString(); }

        var isAuthenticated = {{ user.is_authenticated|yesno:"true,false" }};

        var sess = null;
        try{ sess = JSON.parse(localStorage.getItem(storageKey) || 'null'); }catch(e){ sess = null; }

        // Ensure a persistent site_session exists for anonymous visitors only.
        // Create one if missing and the user is not authenticated.
        if(!sess && !isAuthenticated){
            sess = { id: makeId(), created_at: nowISO() };
            try{ localStorage.setItem(storageKey, JSON.stringify(sess)); }catch(e){}
        }

        // Expose to other scripts. If no session (e.g. logged-in user), these will be null.
        window.siteSession = sess;
        window.siteSessionId = sess ? sess.id : null;
        window.getSiteSession = function(){ return window.siteSession || null; };
    })();
    </script>

    {% block extra_js %}{% endblock %}

</body>
</html>